

============================== 11:51:18.981197 | 80714572-614d-4298-b882-ea214bd74faa ==============================
[0m11:51:18.981197 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:51:18.982337 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m11:51:19.224403 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-_4t8qmx8'
[0m11:51:19.225389 [debug] [Dummy-1   ]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:51:19.253455 [debug] [Dummy-1   ]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:51:19.254512 [debug] [Dummy-1   ]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:51:19.280667 [debug] [Dummy-1   ]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:51:19.300492 [info ] [Dummy-1   ]: Updating lock file in file path: /tmp/dbt/package-lock.yml
[0m11:51:19.302971 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-7pec2i_t'
[0m11:51:19.308315 [info ] [Dummy-1   ]: Installing dbt-labs/dbt_utils
[0m11:51:19.503418 [info ] [Dummy-1   ]: Installed from version 1.3.0
[0m11:51:19.504015 [info ] [Dummy-1   ]: Up to date!
[0m11:51:19.506232 [debug] [Dummy-1   ]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6216073, "process_in_blocks": "0", "process_kernel_time": 0.76, "process_mem_max_rss": "394148", "process_out_blocks": "0", "process_user_time": 4.01}
[0m11:51:19.506965 [debug] [Dummy-1   ]: Command `cli deps` succeeded at 11:51:19.506687 after 0.62 seconds
[0m11:51:19.507530 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:53:18.306224 | ff1d4ac4-f185-42ea-bc35-47fc902ab665 ==============================
[0m11:53:18.306224 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:53:18.307322 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:53:18.545742 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-tbib8oyx'
[0m11:53:18.546676 [debug] [Dummy-1   ]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:53:18.573367 [debug] [Dummy-1   ]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:53:18.574396 [debug] [Dummy-1   ]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:53:18.598739 [debug] [Dummy-1   ]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:53:18.618401 [info ] [Dummy-1   ]: Updating lock file in file path: /tmp/dbt/package-lock.yml
[0m11:53:18.624073 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-wflhnfqj'
[0m11:53:18.629388 [info ] [Dummy-1   ]: Installing dbt-labs/dbt_utils
[0m11:53:18.803222 [info ] [Dummy-1   ]: Installed from version 1.3.0
[0m11:53:18.803810 [info ] [Dummy-1   ]: Up to date!
[0m11:53:18.806400 [debug] [Dummy-1   ]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59581083, "process_in_blocks": "0", "process_kernel_time": 0.88, "process_mem_max_rss": "392268", "process_out_blocks": "0", "process_user_time": 3.85}
[0m11:53:18.807118 [debug] [Dummy-1   ]: Command `cli deps` succeeded at 11:53:18.806842 after 0.60 seconds
[0m11:53:18.807687 [debug] [Dummy-1   ]: Flushing usage events


============================== 11:54:01.159995 | dc4c5be3-c96a-410e-ac50-13adeb4fe82d ==============================
[0m11:54:01.159995 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m11:54:01.161110 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m11:54:01.402355 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-ugcb7n_3'
[0m11:54:01.403330 [debug] [Dummy-1   ]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:54:01.430204 [debug] [Dummy-1   ]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:54:01.431248 [debug] [Dummy-1   ]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:54:01.456387 [debug] [Dummy-1   ]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:54:01.476254 [info ] [Dummy-1   ]: Updating lock file in file path: /tmp/dbt/package-lock.yml
[0m11:54:01.483609 [debug] [Dummy-1   ]: Set downloads directory='/tmp/dbt-downloads-pl8mab0a'
[0m11:54:01.488991 [info ] [Dummy-1   ]: Installing dbt-labs/dbt_utils
[0m11:54:01.670828 [info ] [Dummy-1   ]: Installed from version 1.3.0
[0m11:54:01.671436 [info ] [Dummy-1   ]: Up to date!
[0m11:54:01.673719 [debug] [Dummy-1   ]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.60906047, "process_in_blocks": "0", "process_kernel_time": 0.77, "process_mem_max_rss": "390488", "process_out_blocks": "0", "process_user_time": 4.0}
[0m11:54:01.674482 [debug] [Dummy-1   ]: Command `cli deps` succeeded at 11:54:01.674155 after 0.61 seconds
[0m11:54:01.675041 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:16:52.087001 | 0e2494fe-a4e6-43c7-b9e0-5668f1fc6a22 ==============================
[0m12:16:52.087001 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:16:52.088347 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:16:52.485036 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:16:53.245417 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:16:53.247102 [info ] [Dummy-1   ]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:16:55.997869 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:16:56.000818 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:16:56.045685 [info ] [Dummy-1   ]: Found 9 models, 20 data tests, 5 sources, 592 macros
[0m12:16:56.050374 [info ] [Dummy-1   ]: 
[0m12:16:56.051035 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:16:56.051529 [info ] [Dummy-1   ]: 
[0m12:16:56.052409 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:16:56.060803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_NOT NEEDED_vending_machine_dbt_db_dev'
[0m12:16:56.181115 [debug] [ThreadPool]: Using snowflake connection "list_NOT NEEDED_vending_machine_dbt_db_dev"
[0m12:16:56.181799 [debug] [ThreadPool]: On list_NOT NEEDED_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_NOT NEEDED_vending_machine_dbt_db_dev"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:16:56.182317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:56.504958 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_NOT NEEDED_vending_machine_dbt_db_dev"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:16:56.505718 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:16:56.506294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:56.822289 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m12:16:56.822970 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m12:16:56.823541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:57.154676 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:16:57.155467 [debug] [Dummy-1   ]: Connection 'list_NOT NEEDED_vending_machine_dbt_db_dev' was properly closed.
[0m12:16:57.156423 [error] [Dummy-1   ]: Encountered an error:
Failed to use database vending_machine_dbt_db: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m12:16:57.171534 [error] [Dummy-1   ]: Traceback (most recent call last):
  File "_udf_code.py", line 315, in new_open_method
    new_session.use_database(creds.database)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 3919, in use_database
    self._use_object(database, "database")
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 3980, in _use_object
    self._run_query(query)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 2837, in _run_query
    return self._conn.run_query(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 133, in wrap
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 127, in wrap
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 520, in run_query
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 505, in run_query
    results_cursor = self.execute_and_notify_query_listener(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 446, in execute_and_notify_query_listener
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 437, in execute_and_notify_query_listener
    results_cursor = self._cursor.execute(query, **kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "_udf_code.py", line 98, in wrapper
    return original_execute(self, sql, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 317, in exception_handler
    yield
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 146, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "_udf_code.py", line 317, in new_open_method
    raise ValueError(f"Failed to use database {creds.database}: {str(e)}")
ValueError: Failed to use database vending_machine_dbt_db: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "_udf_code.py", line 315, in new_open_method
    new_session.use_database(creds.database)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 3919, in use_database
    self._use_object(database, "database")
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 3980, in _use_object
    self._run_query(query)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 2837, in _run_query
    return self._conn.run_query(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 133, in wrap
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 127, in wrap
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 520, in run_query
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 505, in run_query
    results_cursor = self.execute_and_notify_query_listener(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 446, in execute_and_notify_query_listener
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 437, in execute_and_notify_query_listener
    results_cursor = self._cursor.execute(query, **kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "_udf_code.py", line 98, in wrapper
    return original_execute(self, sql, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 317, in exception_handler
    yield
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 21, in macro
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/clients/jinja.py", line 91, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 59, in macro
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/clients/jinja.py", line 91, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/clients/jinja.py", line 91, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 438, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 514, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 551, in add_query
    connection, cursor = self._add_standard_queries(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 607, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 525, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 130, in add_query
    with self.exception_handler(sql):
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 350, in exception_handler
    self.rollback_if_open()
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "_udf_code.py", line 317, in new_open_method
    raise ValueError(f"Failed to use database {creds.database}: {str(e)}")
ValueError: Failed to use database vending_machine_dbt_db: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "_udf_code.py", line 315, in new_open_method
    new_session.use_database(creds.database)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 3919, in use_database
    self._use_object(database, "database")
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 3980, in _use_object
    self._run_query(query)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/session.py", line 2837, in _run_query
    return self._conn.run_query(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 133, in wrap
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 127, in wrap
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 520, in run_query
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 505, in run_query
    results_cursor = self.execute_and_notify_query_listener(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 446, in execute_and_notify_query_listener
    raise ex
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/snowpark/_internal/server_connection.py", line 437, in execute_and_notify_query_listener
    results_cursor = self._cursor.execute(query, **kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "_udf_code.py", line 98, in wrapper
    return original_execute(self, sql, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/cursor.py", line 1092, in execute
    Error.errorhandler_wrapper(
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 232, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 287, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/snowflake/connector/errors.py", line 165, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/cli/main.py", line 341, in compile
    results = task.run()
              ^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/task/runnable.py", line 619, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/task/runnable.py", line 557, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/task/runnable.py", line 533, in before_run
    self.populate_adapter_cache(adapter)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/task/runnable.py", line 522, in populate_adapter_cache
    adapter.set_relations_cache(cachable_nodes)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 618, in set_relations_cache
    self._relations_cache_for_schemas(relation_configs, required_schemas)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 594, in _relations_cache_for_schemas
    for relation in future.result():
                    ^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt_common/utils/executor.py", line 20, in connected
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/impl.py", line 258, in list_relations_without_caching
    schema_objects = self.execute_macro(LIST_RELATIONS_MACRO_NAME, kwargs=kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 1275, in execute_macro
    with self.connections.exception_handler(f"macro {macro_name}"):
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/snowflake/connections.py", line 350, in exception_handler
    self.rollback_if_open()
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/base/connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
  File "/usr/lib/python_udf/8a205822f5ec223037aacf04045ed744280f4d8bc6c0e32d80f64ff609b49471/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "_udf_code.py", line 317, in new_open_method
    raise ValueError(f"Failed to use database {creds.database}: {str(e)}")
ValueError: Failed to use database vending_machine_dbt_db: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.

[0m12:16:57.175406 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 5.1883607, "process_in_blocks": "0", "process_kernel_time": 1.17, "process_mem_max_rss": "464464", "process_out_blocks": "0", "process_user_time": 7.53}
[0m12:16:57.176193 [debug] [Dummy-1   ]: Command `cli compile` failed at 12:16:57.175868 after 5.19 seconds
[0m12:16:57.176793 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:17:50.576595 | 0d7661e3-d3e8-4750-b935-a2ea6519f205 ==============================
[0m12:17:50.576595 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:17:50.577606 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/tmp/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'False'}
[0m12:17:50.937419 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:17:51.663078 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:17:51.948149 [info ] [Dummy-1   ]: Unable to do partial parsing because profile has changed
[0m12:17:51.948857 [info ] [Dummy-1   ]: Unable to do partial parsing because a project config has changed
[0m12:17:54.326362 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:17:54.329142 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:17:54.369559 [info ] [Dummy-1   ]: Found 9 models, 20 data tests, 5 sources, 592 macros
[0m12:17:54.373643 [info ] [Dummy-1   ]: 
[0m12:17:54.374256 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:17:54.374763 [info ] [Dummy-1   ]: 
[0m12:17:54.375705 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:17:54.383145 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INSTRUCTOR2_vending_machine_dbt_db_dev'
[0m12:17:54.526340 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:17:54.526983 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:17:54.527508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:55.116881 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.589 seconds
[0m12:17:55.122644 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:17:55.123228 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
show objects in INSTRUCTOR2_vending_machine_dbt_db.dev
    limit 10000
    
;
[0m12:17:55.185345 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.061 seconds
[0m12:17:55.187652 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:17:55.188187 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:17:55.279943 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.091 seconds
[0m12:17:55.287202 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_customer_details
[0m12:17:55.287960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_INSTRUCTOR2_vending_machine_dbt_db_dev, now model.vending_machine_dbt.raw_customer_details)
[0m12:17:55.288582 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_customer_details
[0m12:17:55.301267 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_customer_details"
[0m12:17:55.302243 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_customer_details
[0m12:17:55.303267 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_customer_details
[0m12:17:55.303924 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_product_details
[0m12:17:55.304685 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_customer_details, now model.vending_machine_dbt.raw_product_details)
[0m12:17:55.305357 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_product_details
[0m12:17:55.311058 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_product_details"
[0m12:17:55.311784 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_product_details
[0m12:17:55.312747 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_product_details
[0m12:17:55.313387 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_survey_feedback
[0m12:17:55.314120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_product_details, now model.vending_machine_dbt.raw_survey_feedback)
[0m12:17:55.314673 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_survey_feedback
[0m12:17:55.320331 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_survey_feedback"
[0m12:17:55.321056 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_survey_feedback
[0m12:17:55.321971 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_survey_feedback
[0m12:17:55.322619 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_vending_machines
[0m12:17:55.323313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_survey_feedback, now model.vending_machine_dbt.raw_vending_machines)
[0m12:17:55.323867 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_vending_machines
[0m12:17:55.329830 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_vending_machines"
[0m12:17:55.330561 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_vending_machines
[0m12:17:55.331464 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_vending_machines
[0m12:17:55.332103 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_vending_transactions
[0m12:17:55.332803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_vending_machines, now model.vending_machine_dbt.raw_vending_transactions)
[0m12:17:55.333362 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_vending_transactions
[0m12:17:55.340784 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_vending_transactions"
[0m12:17:55.341500 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_vending_transactions
[0m12:17:55.342413 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_vending_transactions
[0m12:17:55.343063 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:17:55.344032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_vending_transactions, now test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744)
[0m12:17:55.344625 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:17:55.352032 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744"
[0m12:17:55.352793 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:17:55.353693 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:17:55.354351 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:17:55.355052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744, now test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b)
[0m12:17:55.355738 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:17:55.363779 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b"
[0m12:17:55.364521 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:17:55.365514 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:17:55.366175 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:17:55.366875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6)
[0m12:17:55.367435 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:17:55.377801 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6"
[0m12:17:55.378543 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:17:55.379451 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:17:55.380079 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:17:55.380763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d)
[0m12:17:55.381319 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:17:55.390152 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d"
[0m12:17:55.390895 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:17:55.391783 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:17:55.392408 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:17:55.393084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316)
[0m12:17:55.393634 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:17:55.400661 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316"
[0m12:17:55.401384 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:17:55.402278 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:17:55.402907 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:17:55.403567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097)
[0m12:17:55.404113 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:17:55.411109 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097"
[0m12:17:55.411838 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:17:55.412724 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:17:55.413348 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:17:55.414021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b)
[0m12:17:55.414598 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:17:55.421730 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b"
[0m12:17:55.422470 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:17:55.423369 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:17:55.423997 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:17:55.424662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb)
[0m12:17:55.425270 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:17:55.433986 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb"
[0m12:17:55.434729 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:17:55.435699 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:17:55.436344 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:17:55.437004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab)
[0m12:17:55.437595 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:17:55.444576 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab"
[0m12:17:55.445376 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:17:55.446295 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:17:55.446922 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:17:55.447586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b)
[0m12:17:55.448136 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:17:55.455047 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b"
[0m12:17:55.455833 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:17:55.456721 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:17:55.457340 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:17:55.457999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a)
[0m12:17:55.458568 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:17:55.465762 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a"
[0m12:17:55.466490 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:17:55.467374 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:17:55.467994 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:17:55.468666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4)
[0m12:17:55.469223 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:17:55.477923 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4"
[0m12:17:55.478654 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:17:55.479541 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:17:55.480166 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:17:55.480835 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d)
[0m12:17:55.481391 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:17:55.488324 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d"
[0m12:17:55.489034 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:17:55.489917 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:17:55.490566 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:17:55.491249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530)
[0m12:17:55.491805 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:17:55.498753 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530"
[0m12:17:55.499485 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:17:55.500369 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:17:55.500994 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:17:55.501669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6)
[0m12:17:55.502239 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:17:55.509417 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6"
[0m12:17:55.510169 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:17:55.511060 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:17:55.511687 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:17:55.512359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c)
[0m12:17:55.512912 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:17:55.524348 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c"
[0m12:17:55.525076 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:17:55.526048 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:17:55.526696 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:17:55.527358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5)
[0m12:17:55.527906 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:17:55.534538 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5"
[0m12:17:55.535303 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:17:55.536204 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:17:55.536829 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:17:55.537504 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006)
[0m12:17:55.538049 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:17:55.544647 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006"
[0m12:17:55.545429 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:17:55.546336 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:17:55.546963 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:17:55.547629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c)
[0m12:17:55.548186 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:17:55.555239 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c"
[0m12:17:55.555971 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:17:55.556871 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:17:55.557499 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:17:55.558171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b)
[0m12:17:55.558728 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:17:55.567313 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b"
[0m12:17:55.568028 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:17:55.568904 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:17:55.569542 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:17:55.570217 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b, now model.vending_machine_dbt.customer_satisfaction_metrics)
[0m12:17:55.570766 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:17:55.576713 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.customer_satisfaction_metrics"
[0m12:17:55.577453 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:17:55.578362 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:17:55.578984 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.daily_product_sales
[0m12:17:55.579640 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.customer_satisfaction_metrics, now model.vending_machine_dbt.daily_product_sales)
[0m12:17:55.580175 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.daily_product_sales
[0m12:17:55.585750 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.daily_product_sales"
[0m12:17:55.586469 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.daily_product_sales
[0m12:17:55.587346 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.daily_product_sales
[0m12:17:55.587967 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.sales_metrics_by_location
[0m12:17:55.588624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.daily_product_sales, now model.vending_machine_dbt.sales_metrics_by_location)
[0m12:17:55.589162 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.sales_metrics_by_location
[0m12:17:55.621140 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.sales_metrics_by_location"
[0m12:17:55.621901 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.sales_metrics_by_location
[0m12:17:55.622812 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.sales_metrics_by_location
[0m12:17:55.623445 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.vending_transactions
[0m12:17:55.624110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.sales_metrics_by_location, now model.vending_machine_dbt.vending_transactions)
[0m12:17:55.624653 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.vending_transactions
[0m12:17:55.630869 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.vending_transactions"
[0m12:17:55.631582 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.vending_transactions
[0m12:17:55.632468 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.vending_transactions
[0m12:17:55.634454 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:17:55.635005 [debug] [Dummy-1   ]: Connection 'model.vending_machine_dbt.vending_transactions' was properly closed.
[0m12:17:55.640198 [debug] [Dummy-1   ]: Command end result
[0m12:17:55.681257 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:17:55.683343 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:17:55.692690 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:17:55.694407 [debug] [Dummy-1   ]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.209424, "process_in_blocks": "0", "process_kernel_time": 1.09, "process_mem_max_rss": "486472", "process_out_blocks": "0", "process_user_time": 7.4}
[0m12:17:55.695070 [debug] [Dummy-1   ]: Command `cli compile` succeeded at 12:17:55.694803 after 5.21 seconds
[0m12:17:55.695668 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:18:38.883879 | b266630b-9133-4557-9820-050f91bc141b ==============================
[0m12:18:38.883879 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:18:38.884917 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/tmp/dbt/', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': '/tmp/dbt/target/', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:18:39.249612 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:18:39.973460 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:18:40.364735 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:40.365479 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:40.563555 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:18:40.566586 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:18:40.619322 [info ] [Dummy-1   ]: Found 9 models, 20 data tests, 5 sources, 592 macros
[0m12:18:40.622471 [info ] [Dummy-1   ]: 
[0m12:18:40.623011 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:18:40.623461 [info ] [Dummy-1   ]: 
[0m12:18:40.624300 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:18:40.631669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INSTRUCTOR2_vending_machine_dbt_db'
[0m12:18:40.766673 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db"
[0m12:18:40.767345 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db"} */
show terse schemas in database INSTRUCTOR2_vending_machine_dbt_db
    limit 10000
[0m12:18:40.767872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:41.430543 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.662 seconds
[0m12:18:41.435286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INSTRUCTOR2_vending_machine_dbt_db_dev'
[0m12:18:41.452876 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:18:41.453453 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:18:41.453976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:41.982713 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.529 seconds
[0m12:18:41.988347 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:18:41.988914 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
show objects in INSTRUCTOR2_vending_machine_dbt_db.dev
    limit 10000
    
;
[0m12:18:42.079526 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.090 seconds
[0m12:18:42.081801 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:18:42.082369 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:18:42.176535 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m12:18:42.183388 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_customer_details
[0m12:18:42.184278 [info ] [Thread-2 (]: 1 of 9 START sql view model dev.raw_customer_details ........................... [RUN]
[0m12:18:42.185000 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_INSTRUCTOR2_vending_machine_dbt_db_dev, now model.vending_machine_dbt.raw_customer_details)
[0m12:18:42.185652 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_customer_details
[0m12:18:42.197227 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_customer_details"
[0m12:18:42.198048 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_customer_details
[0m12:18:42.249179 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.raw_customer_details"
[0m12:18:42.250666 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.raw_customer_details"
[0m12:18:42.251298 [debug] [Thread-2 (]: On model.vending_machine_dbt.raw_customer_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.raw_customer_details"} */
create or replace   view INSTRUCTOR2_vending_machine_dbt_db.dev.raw_customer_details
  
   as (
    -- This staging model selects all columns from the raw customer details table.
-- File: raw_customer_details.sql
SELECT
    customer_id,
    age,
    gender,
    email_address
FROM INSTRUCTOR1_vending_machine_dbt_db.RAW.CUSTOMER_DETAILS
  );
[0m12:18:42.251866 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:43.158005 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m12:18:43.190066 [info ] [Thread-2 (]: 1 of 9 OK created sql view model dev.raw_customer_details ...................... [[32mSUCCESS 1[0m in 1.00s]
[0m12:18:43.191028 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_customer_details
[0m12:18:43.191700 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_product_details
[0m12:18:43.192541 [info ] [Thread-2 (]: 2 of 9 START sql view model dev.raw_product_details ............................ [RUN]
[0m12:18:43.193266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_customer_details, now model.vending_machine_dbt.raw_product_details)
[0m12:18:43.193852 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_product_details
[0m12:18:43.199715 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_product_details"
[0m12:18:43.200510 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_product_details
[0m12:18:43.206037 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.raw_product_details"
[0m12:18:43.207306 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.raw_product_details"
[0m12:18:43.207927 [debug] [Thread-2 (]: On model.vending_machine_dbt.raw_product_details: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.raw_product_details"} */
create or replace   view INSTRUCTOR2_vending_machine_dbt_db.dev.raw_product_details
  
   as (
    -- This staging model selects all columns from the raw product details table.
-- File: raw_product_details.sql
SELECT
    product_id,
    product_name,
    product_category,
    unit_price
FROM INSTRUCTOR1_vending_machine_dbt_db.RAW.PRODUCT_DETAILS
  );
[0m12:18:43.208484 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:44.124881 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.916 seconds
[0m12:18:44.128299 [info ] [Thread-2 (]: 2 of 9 OK created sql view model dev.raw_product_details ....................... [[32mSUCCESS 1[0m in 0.93s]
[0m12:18:44.129158 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_product_details
[0m12:18:44.129810 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_survey_feedback
[0m12:18:44.130638 [info ] [Thread-2 (]: 3 of 9 START sql view model dev.raw_survey_feedback ............................ [RUN]
[0m12:18:44.131284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_product_details, now model.vending_machine_dbt.raw_survey_feedback)
[0m12:18:44.131829 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_survey_feedback
[0m12:18:44.137934 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_survey_feedback"
[0m12:18:44.138771 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_survey_feedback
[0m12:18:44.146296 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.raw_survey_feedback"
[0m12:18:44.147575 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.raw_survey_feedback"
[0m12:18:44.148185 [debug] [Thread-2 (]: On model.vending_machine_dbt.raw_survey_feedback: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.raw_survey_feedback"} */
create or replace   view INSTRUCTOR2_vending_machine_dbt_db.dev.raw_survey_feedback
  
   as (
    -- This staging model selects all columns from the raw survey feedback table.
SELECT
    survey_id,
    transaction_id,
    customer_id,
    satisfaction_score
FROM INSTRUCTOR1_vending_machine_dbt_db.RAW.SURVEY_FEEDBACK
  );
[0m12:18:44.148739 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:45.054671 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.906 seconds
[0m12:18:45.058107 [info ] [Thread-2 (]: 3 of 9 OK created sql view model dev.raw_survey_feedback ....................... [[32mSUCCESS 1[0m in 0.93s]
[0m12:18:45.059004 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_survey_feedback
[0m12:18:45.059680 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_vending_machines
[0m12:18:45.060574 [info ] [Thread-2 (]: 4 of 9 START sql view model dev.raw_vending_machines ........................... [RUN]
[0m12:18:45.061240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_survey_feedback, now model.vending_machine_dbt.raw_vending_machines)
[0m12:18:45.061785 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_vending_machines
[0m12:18:45.068009 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_vending_machines"
[0m12:18:45.068798 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_vending_machines
[0m12:18:45.074168 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.raw_vending_machines"
[0m12:18:45.075492 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.raw_vending_machines"
[0m12:18:45.076124 [debug] [Thread-2 (]: On model.vending_machine_dbt.raw_vending_machines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.raw_vending_machines"} */
create or replace   view INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_machines
  
   as (
    -- This staging model selects all columns from the raw vending machines table.
SELECT
    vending_machine_id,
    location_city,
    region,
    country
FROM INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_MACHINES
  );
[0m12:18:45.076688 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:45.925768 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m12:18:45.929109 [info ] [Thread-2 (]: 4 of 9 OK created sql view model dev.raw_vending_machines ...................... [[32mSUCCESS 1[0m in 0.87s]
[0m12:18:45.929963 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_vending_machines
[0m12:18:45.930647 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.raw_vending_transactions
[0m12:18:45.931454 [info ] [Thread-2 (]: 5 of 9 START sql view model dev.raw_vending_transactions ....................... [RUN]
[0m12:18:45.932115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_vending_machines, now model.vending_machine_dbt.raw_vending_transactions)
[0m12:18:45.932660 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.raw_vending_transactions
[0m12:18:45.938816 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.raw_vending_transactions"
[0m12:18:45.939618 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.raw_vending_transactions
[0m12:18:45.946995 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.raw_vending_transactions"
[0m12:18:45.948362 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.raw_vending_transactions"
[0m12:18:45.948999 [debug] [Thread-2 (]: On model.vending_machine_dbt.raw_vending_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.raw_vending_transactions"} */
create or replace   view INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_transactions
  
   as (
    -- This staging model selects all columns from the raw vending transactions table.
-- It's a foundational model that other models will build upon.
SELECT
    transaction_id,
    vending_machine_id,
    transaction_timestamp,
    product_id,
    quantity,
    transaction_total_amount,
    payment_method,
    customer_id
FROM INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
  );
[0m12:18:45.949562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:46.693208 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m12:18:46.696592 [info ] [Thread-2 (]: 5 of 9 OK created sql view model dev.raw_vending_transactions .................. [[32mSUCCESS 1[0m in 0.76s]
[0m12:18:46.697444 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.raw_vending_transactions
[0m12:18:46.698825 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:18:46.699722 [info ] [Thread-2 (]: 6 of 9 START sql table model dev.customer_satisfaction_metrics ................. [RUN]
[0m12:18:46.700697 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.raw_vending_transactions, now model.vending_machine_dbt.customer_satisfaction_metrics)
[0m12:18:46.701266 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:18:46.707842 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.customer_satisfaction_metrics"
[0m12:18:46.708616 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:18:46.741093 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.customer_satisfaction_metrics"
[0m12:18:46.743161 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.customer_satisfaction_metrics"
[0m12:18:46.743876 [debug] [Thread-2 (]: On model.vending_machine_dbt.customer_satisfaction_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.customer_satisfaction_metrics"} */
create or replace transient table INSTRUCTOR2_vending_machine_dbt_db.dev.customer_satisfaction_metrics
         as
        (-- This model aggregates survey feedback to calculate key customer satisfaction metrics.
-- It joins raw survey feedback with vending transaction data to link feedback to specific events.
SELECT
  cd.customer_id,
  cd.gender,
  cd.age,
  cd.email_address,
  AVG(sf.satisfaction_score) AS average_satisfaction,
  ARRAY_AGG (DISTINCT vt.vending_machine_id) AS visited_machines_array,
  COUNT(DISTINCT sf.survey_id) AS surveys_completed
FROM
  		INSTRUCTOR2_vending_machine_dbt_db.dev.raw_survey_feedback AS sf
  JOIN 
		INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_transactions AS vt ON sf.transaction_id = vt.transaction_id
  JOIN 
		INSTRUCTOR2_vending_machine_dbt_db.dev.raw_customer_details AS cd ON sf.customer_id = cd.customer_id
GROUP BY
  cd.customer_id,
  cd.gender,
  cd.age,
  cd.email_address
        );
[0m12:18:46.744464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:49.499234 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.755 seconds
[0m12:18:49.502721 [info ] [Thread-2 (]: 6 of 9 OK created sql table model dev.customer_satisfaction_metrics ............ [[32mSUCCESS 1[0m in 2.80s]
[0m12:18:49.503604 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.customer_satisfaction_metrics
[0m12:18:49.504263 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.daily_product_sales
[0m12:18:49.505050 [info ] [Thread-2 (]: 7 of 9 START sql table model dev.daily_product_sales ........................... [RUN]
[0m12:18:49.505798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.customer_satisfaction_metrics, now model.vending_machine_dbt.daily_product_sales)
[0m12:18:49.506385 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.daily_product_sales
[0m12:18:49.514420 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.daily_product_sales"
[0m12:18:49.515276 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.daily_product_sales
[0m12:18:49.520492 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.daily_product_sales"
[0m12:18:49.522542 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.daily_product_sales"
[0m12:18:49.523211 [debug] [Thread-2 (]: On model.vending_machine_dbt.daily_product_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.daily_product_sales"} */
create or replace transient table INSTRUCTOR2_vending_machine_dbt_db.dev.daily_product_sales
         as
        (with vending_transactions as (

select
    vt.transaction_id,
    vt.transaction_timestamp,
    vt.product_id,
    vt.quantity,
    vt.transaction_total_amount,
    pd.product_name,
    pd.product_category
from INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_transactions vt
inner join INSTRUCTOR2_vending_machine_dbt_db.dev.raw_product_details pd on vt.product_id = pd.product_id
)

select

product_name,
product_category,
date_trunc('day', transaction_timestamp) as sales_date,
sum(quantity) as total_items_sold,
sum(transaction_total_amount) as total_revenue,
count(distinct transaction_id) as total_transactions
from vending_transactions group by 1, 2, 3 order by 1, 2, 3
        );
[0m12:18:49.523787 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:51.075111 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.551 seconds
[0m12:18:51.078419 [info ] [Thread-2 (]: 7 of 9 OK created sql table model dev.daily_product_sales ...................... [[32mSUCCESS 1[0m in 1.57s]
[0m12:18:51.079269 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.daily_product_sales
[0m12:18:51.079923 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.sales_metrics_by_location
[0m12:18:51.080742 [info ] [Thread-2 (]: 8 of 9 START python table model dev.sales_metrics_by_location .................. [RUN]
[0m12:18:51.081403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.daily_product_sales, now model.vending_machine_dbt.sales_metrics_by_location)
[0m12:18:51.081948 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.sales_metrics_by_location
[0m12:18:51.113266 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.sales_metrics_by_location"
[0m12:18:51.114068 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.sales_metrics_by_location
[0m12:18:51.122453 [debug] [Thread-2 (]: Writing runtime python for node "model.vending_machine_dbt.sales_metrics_by_location"
[0m12:18:51.124987 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.sales_metrics_by_location"
[0m12:18:51.126092 [debug] [Thread-2 (]: On model.vending_machine_dbt.sales_metrics_by_location: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.sales_metrics_by_location"} */
WITH sales_metrics_by_location__dbt_sp AS PROCEDURE ()

RETURNS STRING
LANGUAGE PYTHON
RUNTIME_VERSION = '3.9'
PACKAGES = ('snowflake-snowpark-python')



HANDLER = 'main'
EXECUTE AS CALLER
AS
$$



  
    
    
from snowflake.snowpark.functions import col, lit, concat, count, sum as sum_, coalesce

def model(dbt, session):
    """
    This Python model demonstrates Snowpark transformations to calculate sales metrics
    by vending machine. It joins transaction data with machine and product details.
    """
    # Get tables using dbt's ref function to reference the raw models
    machines_df = dbt.ref('raw_vending_machines')
    transactions_df = dbt.ref('raw_vending_transactions')
    
    # Aggregate transactions to get total sales and transactions per machine
    machine_metrics = (
        transactions_df
        .join(machines_df, "VENDING_MACHINE_ID", "inner")
        .groupBy("VENDING_MACHINE_ID", "LOCATION_CITY", "REGION", "COUNTRY")
        .agg(
            sum_("TRANSACTION_TOTAL_AMOUNT").alias("TOTAL_SALES"),
            count("TRANSACTION_ID").alias("TRANSACTION_COUNT")
        )
    )
    
    # Return the final dataframe with key metrics
    return machine_metrics


# This part is user provided model code
# you will need to copy the next section to run the code
# COMMAND ----------
# this part is dbt logic for get ref work, do not modify

def ref(*args, **kwargs):
    refs = {"raw_vending_machines": "INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_machines", "raw_vending_transactions": "INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_transactions"}
    key = '.'.join(args)
    version = kwargs.get("v") or kwargs.get("version")
    if version:
        key += f".v{version}"
    dbt_load_df_function = kwargs.get("dbt_load_df_function")
    return dbt_load_df_function(refs[key])


def source(*args, dbt_load_df_function):
    sources = {}
    key = '.'.join(args)
    return dbt_load_df_function(sources[key])


config_dict = {}


class config:
    def __init__(self, *args, **kwargs):
        pass

    @staticmethod
    def get(key, default=None):
        return config_dict.get(key, default)

class this:
    """dbt.this() or dbt.this.identifier"""
    database = "INSTRUCTOR2_vending_machine_dbt_db"
    schema = "dev"
    identifier = "sales_metrics_by_location"
    
    def __repr__(self):
        return 'INSTRUCTOR2_vending_machine_dbt_db.dev.sales_metrics_by_location'


class dbtObj:
    def __init__(self, load_df_function) -> None:
        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)
        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)
        self.config = config
        self.this = this()
        self.is_incremental = False

# COMMAND ----------



def materialize(session, df, target_relation):
    # make sure pandas exists
    import importlib.util
    package_name = 'pandas'
    if importlib.util.find_spec(package_name):
        import pandas
        if isinstance(df, pandas.core.frame.DataFrame):
          session.use_database(target_relation.database)
          session.use_schema(target_relation.schema)
          # session.write_pandas does not have overwrite function
          df = session.createDataFrame(df)
    
    df.write.mode("overwrite").save_as_table('INSTRUCTOR2_vending_machine_dbt_db.dev.sales_metrics_by_location', table_type='transient')

def main(session):
    dbt = dbtObj(session.table)
    df = model(dbt, session)
    materialize(session, df, dbt.this)
    return "OK"

  
$$
CALL sales_metrics_by_location__dbt_sp();
[0m12:18:51.126912 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:57.131957 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.005 seconds
[0m12:18:57.135847 [info ] [Thread-2 (]: 8 of 9 OK created python table model dev.sales_metrics_by_location ............. [[32mSUCCESS 1[0m in 6.05s]
[0m12:18:57.136729 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.sales_metrics_by_location
[0m12:18:57.137398 [debug] [Thread-2 (]: Began running node model.vending_machine_dbt.vending_transactions
[0m12:18:57.138436 [info ] [Thread-2 (]: 9 of 9 START sql table model dev.vending_transactions .......................... [RUN]
[0m12:18:57.139135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vending_machine_dbt.sales_metrics_by_location, now model.vending_machine_dbt.vending_transactions)
[0m12:18:57.139731 [debug] [Thread-2 (]: Began compiling node model.vending_machine_dbt.vending_transactions
[0m12:18:57.146882 [debug] [Thread-2 (]: Writing injected SQL for node "model.vending_machine_dbt.vending_transactions"
[0m12:18:57.147677 [debug] [Thread-2 (]: Began executing node model.vending_machine_dbt.vending_transactions
[0m12:18:57.153032 [debug] [Thread-2 (]: Writing runtime sql for node "model.vending_machine_dbt.vending_transactions"
[0m12:18:57.155255 [debug] [Thread-2 (]: Using snowflake connection "model.vending_machine_dbt.vending_transactions"
[0m12:18:57.156004 [debug] [Thread-2 (]: On model.vending_machine_dbt.vending_transactions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "model.vending_machine_dbt.vending_transactions"} */
create or replace transient table INSTRUCTOR2_vending_machine_dbt_db.dev.vending_transactions
         as
        (-- This model joins various raw tables related to vending transactions to create a single, comprehensive view.
-- It links transactions to customer details, products, and vending machine information.
SELECT
    vt.transaction_id,
    vt.transaction_timestamp,
    vt.vending_machine_id,
    vt.product_id,
    pd.product_name,
    pd.product_category,
    pd.unit_price,
    vt.quantity,
    vt.transaction_total_amount,
    vt.payment_method,
    vm.location_city,
    vm.region,
    vm.country,
    c.customer_id,
    c.age,
    c.gender,
    c.email_address
FROM INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_transactions vt
JOIN INSTRUCTOR2_vending_machine_dbt_db.dev.raw_product_details pd
    ON vt.product_id = pd.product_id
JOIN INSTRUCTOR2_vending_machine_dbt_db.dev.raw_vending_machines vm
    ON vt.vending_machine_id = vm.vending_machine_id
LEFT JOIN INSTRUCTOR2_vending_machine_dbt_db.dev.raw_customer_details c
    ON vt.customer_id = c.customer_id
        );
[0m12:18:57.156621 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:58.676532 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.520 seconds
[0m12:18:58.679695 [info ] [Thread-2 (]: 9 of 9 OK created sql table model dev.vending_transactions ..................... [[32mSUCCESS 1[0m in 1.54s]
[0m12:18:58.680542 [debug] [Thread-2 (]: Finished running node model.vending_machine_dbt.vending_transactions
[0m12:18:58.682843 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:18:58.683363 [debug] [Dummy-1   ]: Connection 'list_INSTRUCTOR2_vending_machine_dbt_db' was properly closed.
[0m12:18:58.683803 [debug] [Dummy-1   ]: Connection 'model.vending_machine_dbt.vending_transactions' was properly closed.
[0m12:18:58.684419 [info ] [Dummy-1   ]: 
[0m12:18:58.684930 [info ] [Dummy-1   ]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 18.06 seconds (18.06s).
[0m12:18:58.687261 [debug] [Dummy-1   ]: Command end result
[0m12:18:58.730015 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:18:58.732140 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:18:58.740074 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:18:58.740576 [info ] [Dummy-1   ]: 
[0m12:18:58.741211 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m12:18:58.741691 [info ] [Dummy-1   ]: 
[0m12:18:58.742214 [info ] [Dummy-1   ]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:18:58.743876 [debug] [Dummy-1   ]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.953146, "process_in_blocks": "0", "process_kernel_time": 1.05, "process_mem_max_rss": "422500", "process_out_blocks": "0", "process_user_time": 5.67}
[0m12:18:58.744526 [debug] [Dummy-1   ]: Command `cli run` succeeded at 12:18:58.744267 after 19.95 seconds
[0m12:18:58.745042 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:22:33.534274 | 12fc2b84-cd96-4c7f-9fc8-69b01e1fc8e8 ==============================
[0m12:22:33.534274 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:22:33.535461 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': '/tmp/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m12:22:33.927004 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:22:34.680455 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:22:35.094600 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:35.095326 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:35.306818 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:22:35.310179 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:22:35.390804 [info ] [Dummy-1   ]: Found 9 models, 20 data tests, 5 sources, 592 macros
[0m12:22:35.395142 [info ] [Dummy-1   ]: 
[0m12:22:35.395799 [info ] [Dummy-1   ]: Concurrency: 1 threads (target='dev')
[0m12:22:35.396322 [info ] [Dummy-1   ]: 
[0m12:22:35.397260 [debug] [Dummy-1   ]: Acquiring new snowflake connection 'master'
[0m12:22:35.405680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INSTRUCTOR2_vending_machine_dbt_db_dev'
[0m12:22:35.557055 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:22:35.557781 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
alter session set quoted_identifiers_ignore_case = false;
[0m12:22:35.558460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:36.230979 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.672 seconds
[0m12:22:36.237025 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:22:36.237716 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
show objects in INSTRUCTOR2_vending_machine_dbt_db.dev
    limit 10000
    
;
[0m12:22:36.385372 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.147 seconds
[0m12:22:36.388518 [debug] [ThreadPool]: Using snowflake connection "list_INSTRUCTOR2_vending_machine_dbt_db_dev"
[0m12:22:36.389165 [debug] [ThreadPool]: On list_INSTRUCTOR2_vending_machine_dbt_db_dev: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "connection_name": "list_INSTRUCTOR2_vending_machine_dbt_db_dev"} */
alter session unset quoted_identifiers_ignore_case;
[0m12:22:36.447584 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.058 seconds
[0m12:22:36.460119 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:22:36.460881 [info ] [Thread-2 (]: 1 of 20 START test dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1  [RUN]
[0m12:22:36.461642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_INSTRUCTOR2_vending_machine_dbt_db_dev, now test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744)
[0m12:22:36.462255 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:22:36.487026 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744"
[0m12:22:36.488044 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:22:36.522106 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744"
[0m12:22:36.523913 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744"
[0m12:22:36.524672 [debug] [Thread-2 (]: On test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not QUANTITY >= 1
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m12:22:36.525294 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:37.239376 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m12:22:37.251465 [info ] [Thread-2 (]: 1 of 20 PASS dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1  [[32mPASS[0m in 0.79s]
[0m12:22:37.252543 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744
[0m12:22:37.253296 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:22:37.254105 [info ] [Thread-2 (]: 2 of 20 START test dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_  [RUN]
[0m12:22:37.254906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.dbt_utils_source_accepted_range_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY__True__1.e0d8a22744, now test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b)
[0m12:22:37.255543 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:22:37.270121 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b"
[0m12:22:37.271078 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:22:37.277034 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b"
[0m12:22:37.278630 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b"
[0m12:22:37.279370 [debug] [Thread-2 (]: On test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS

where not(TRANSACTION_TIMESTAMP  <= current_timestamp())


      
    ) dbt_internal_test
[0m12:22:37.279993 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:37.992742 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.713 seconds
[0m12:22:37.995956 [info ] [Thread-2 (]: 2 of 20 PASS dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_  [[32mPASS[0m in 0.74s]
[0m12:22:37.997070 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b
[0m12:22:37.997895 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:22:37.998811 [info ] [Thread-2 (]: 3 of 20 START test source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID  [RUN]
[0m12:22:37.999687 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.dbt_utils_source_expression_is_true_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP___column_name_current_timestamp_.afa6afc41b, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6)
[0m12:22:38.000355 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:22:38.015243 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6"
[0m12:22:38.016214 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:22:38.022371 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6"
[0m12:22:38.023961 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6"
[0m12:22:38.024718 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select CUSTOMER_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.CUSTOMER_DETAILS
where CUSTOMER_ID is null



      
    ) dbt_internal_test
[0m12:22:38.025355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:38.720730 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m12:22:38.724180 [info ] [Thread-2 (]: 3 of 20 PASS source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID  [[32mPASS[0m in 0.72s]
[0m12:22:38.725169 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6
[0m12:22:38.725937 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:22:38.726749 [info ] [Thread-2 (]: 4 of 20 START test source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY  [RUN]
[0m12:22:38.727540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.2703e803f6, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d)
[0m12:22:38.728232 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:22:38.737074 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d"
[0m12:22:38.738028 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:22:38.744278 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d"
[0m12:22:38.745790 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d"
[0m12:22:38.746487 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRODUCT_CATEGORY
from INSTRUCTOR1_vending_machine_dbt_db.RAW.PRODUCT_DETAILS
where PRODUCT_CATEGORY is null



      
    ) dbt_internal_test
[0m12:22:38.747108 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:39.424013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m12:22:39.427120 [info ] [Thread-2 (]: 4 of 20 PASS source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY  [[32mPASS[0m in 0.70s]
[0m12:22:39.428207 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d
[0m12:22:39.428991 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:22:39.429749 [info ] [Thread-2 (]: 5 of 20 START test source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID  [RUN]
[0m12:22:39.430501 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_CATEGORY.51ce1b451d, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316)
[0m12:22:39.431121 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:22:39.442250 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316"
[0m12:22:39.443227 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:22:39.449219 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316"
[0m12:22:39.450776 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316"
[0m12:22:39.451496 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRODUCT_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.PRODUCT_DETAILS
where PRODUCT_ID is null



      
    ) dbt_internal_test
[0m12:22:39.452078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:40.102229 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m12:22:40.105272 [info ] [Thread-2 (]: 5 of 20 PASS source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID . [[32mPASS[0m in 0.67s]
[0m12:22:40.106243 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316
[0m12:22:40.106990 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:22:40.107777 [info ] [Thread-2 (]: 6 of 20 START test source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME  [RUN]
[0m12:22:40.108633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.c532f4e316, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097)
[0m12:22:40.109269 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:22:40.118184 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097"
[0m12:22:40.119173 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:22:40.125001 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097"
[0m12:22:40.126426 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097"
[0m12:22:40.127121 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRODUCT_NAME
from INSTRUCTOR1_vending_machine_dbt_db.RAW.PRODUCT_DETAILS
where PRODUCT_NAME is null



      
    ) dbt_internal_test
[0m12:22:40.127702 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:41.480649 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m12:22:41.483665 [info ] [Thread-2 (]: 6 of 20 PASS source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME  [[32mPASS[0m in 1.37s]
[0m12:22:41.484631 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097
[0m12:22:41.485358 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:22:41.486127 [info ] [Thread-2 (]: 7 of 20 START test source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE  [RUN]
[0m12:22:41.486900 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_NAME.6534e89097, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b)
[0m12:22:41.487517 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:22:41.498911 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b"
[0m12:22:41.499865 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:22:41.505794 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b"
[0m12:22:41.507271 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b"
[0m12:22:41.507968 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SATISFACTION_SCORE
from INSTRUCTOR1_vending_machine_dbt_db.RAW.SURVEY_FEEDBACK
where SATISFACTION_SCORE is null



      
    ) dbt_internal_test
[0m12:22:41.508704 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:42.126788 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m12:22:42.130001 [info ] [Thread-2 (]: 7 of 20 PASS source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE  [[32mPASS[0m in 0.64s]
[0m12:22:42.131004 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b
[0m12:22:42.131765 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:22:42.132533 [info ] [Thread-2 (]: 8 of 20 START test source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID  [RUN]
[0m12:22:42.133280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SATISFACTION_SCORE.ebf3ad212b, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb)
[0m12:22:42.133878 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:22:42.142806 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb"
[0m12:22:42.143786 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:22:42.152126 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb"
[0m12:22:42.153624 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb"
[0m12:22:42.154333 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select SURVEY_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.SURVEY_FEEDBACK
where SURVEY_ID is null



      
    ) dbt_internal_test
[0m12:22:42.154939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:42.709736 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m12:22:42.712832 [info ] [Thread-2 (]: 8 of 20 PASS source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID .. [[32mPASS[0m in 0.58s]
[0m12:22:42.713816 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb
[0m12:22:42.714542 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:22:42.715318 [info ] [Thread-2 (]: 9 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID  [RUN]
[0m12:22:42.716072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.120b9b7abb, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab)
[0m12:22:42.716659 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:22:42.725390 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab"
[0m12:22:42.726347 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:22:42.732277 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab"
[0m12:22:42.733733 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab"
[0m12:22:42.734427 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VENDING_MACHINE_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_MACHINES
where VENDING_MACHINE_ID is null



      
    ) dbt_internal_test
[0m12:22:42.735020 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:43.377517 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m12:22:43.380600 [info ] [Thread-2 (]: 9 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID  [[32mPASS[0m in 0.66s]
[0m12:22:43.381577 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab
[0m12:22:43.382310 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:22:43.383076 [info ] [Thread-2 (]: 10 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID  [RUN]
[0m12:22:43.383867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.f6bedf81ab, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b)
[0m12:22:43.384494 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:22:43.393560 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b"
[0m12:22:43.394502 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:22:43.402741 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b"
[0m12:22:43.404253 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b"
[0m12:22:43.404956 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select PRODUCT_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where PRODUCT_ID is null



      
    ) dbt_internal_test
[0m12:22:43.405536 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:44.015878 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m12:22:44.018912 [info ] [Thread-2 (]: 10 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID  [[32mPASS[0m in 0.63s]
[0m12:22:44.019912 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b
[0m12:22:44.020651 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:22:44.021386 [info ] [Thread-2 (]: 11 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY  [RUN]
[0m12:22:44.022134 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_PRODUCT_ID.8620ca911b, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a)
[0m12:22:44.022745 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:22:44.031651 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a"
[0m12:22:44.032576 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:22:44.038482 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a"
[0m12:22:44.039921 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a"
[0m12:22:44.040608 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select QUANTITY
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where QUANTITY is null



      
    ) dbt_internal_test
[0m12:22:44.041190 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:44.609028 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m12:22:44.611991 [info ] [Thread-2 (]: 11 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY  [[32mPASS[0m in 0.59s]
[0m12:22:44.612969 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a
[0m12:22:44.613712 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:22:44.614449 [info ] [Thread-2 (]: 12 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID  [RUN]
[0m12:22:44.615223 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_QUANTITY.9dba4dac2a, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4)
[0m12:22:44.615827 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:22:44.624641 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4"
[0m12:22:44.625590 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:22:44.634044 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4"
[0m12:22:44.635534 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4"
[0m12:22:44.636230 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select TRANSACTION_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where TRANSACTION_ID is null



      
    ) dbt_internal_test
[0m12:22:44.636822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:45.229854 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m12:22:45.232966 [info ] [Thread-2 (]: 12 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID  [[32mPASS[0m in 0.62s]
[0m12:22:45.233957 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4
[0m12:22:45.234705 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:22:45.235450 [info ] [Thread-2 (]: 13 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP  [RUN]
[0m12:22:45.236192 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.ce1c5f37b4, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d)
[0m12:22:45.236805 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:22:45.245748 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d"
[0m12:22:45.246676 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:22:45.252643 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d"
[0m12:22:45.254195 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d"
[0m12:22:45.254943 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select TRANSACTION_TIMESTAMP
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where TRANSACTION_TIMESTAMP is null



      
    ) dbt_internal_test
[0m12:22:45.255544 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:45.963599 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m12:22:45.966592 [info ] [Thread-2 (]: 13 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP  [[32mPASS[0m in 0.73s]
[0m12:22:45.967625 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d
[0m12:22:45.968503 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:22:45.969271 [info ] [Thread-2 (]: 14 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT  [RUN]
[0m12:22:45.970027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TIMESTAMP.c98baef30d, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530)
[0m12:22:45.970636 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:22:45.981692 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530"
[0m12:22:45.982605 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:22:45.988478 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530"
[0m12:22:45.989970 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530"
[0m12:22:45.990663 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select TRANSACTION_TOTAL_AMOUNT
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where TRANSACTION_TOTAL_AMOUNT is null



      
    ) dbt_internal_test
[0m12:22:45.991295 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:46.479297 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m12:22:46.482187 [info ] [Thread-2 (]: 14 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT  [[32mPASS[0m in 0.51s]
[0m12:22:46.483190 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530
[0m12:22:46.483934 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:22:46.484702 [info ] [Thread-2 (]: 15 of 20 START test source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID  [RUN]
[0m12:22:46.485445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_TOTAL_AMOUNT.ec41e91530, now test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6)
[0m12:22:46.486048 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:22:46.494860 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6"
[0m12:22:46.495840 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:22:46.501836 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6"
[0m12:22:46.503312 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6"
[0m12:22:46.503986 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select VENDING_MACHINE_ID
from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where VENDING_MACHINE_ID is null



      
    ) dbt_internal_test
[0m12:22:46.504562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:47.146992 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m12:22:47.150029 [info ] [Thread-2 (]: 15 of 20 PASS source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID  [[32mPASS[0m in 0.66s]
[0m12:22:47.151006 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6
[0m12:22:47.151741 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:22:47.152470 [info ] [Thread-2 (]: 16 of 20 START test source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID  [RUN]
[0m12:22:47.153208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_not_null_vending_machine_dbt_db_VENDING_TRANSACTIONS_VENDING_MACHINE_ID.5aa37bc8d6, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c)
[0m12:22:47.153793 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:22:47.168333 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c"
[0m12:22:47.169294 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:22:47.175063 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c"
[0m12:22:47.176625 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c"
[0m12:22:47.177320 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CUSTOMER_ID as unique_field,
    count(*) as n_records

from INSTRUCTOR1_vending_machine_dbt_db.RAW.CUSTOMER_DETAILS
where CUSTOMER_ID is not null
group by CUSTOMER_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m12:22:47.177911 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:47.877825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m12:22:47.880940 [info ] [Thread-2 (]: 16 of 20 PASS source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID  [[32mPASS[0m in 0.73s]
[0m12:22:47.881920 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c
[0m12:22:47.882656 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:22:47.883510 [info ] [Thread-2 (]: 17 of 20 START test source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID  [RUN]
[0m12:22:47.884290 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_CUSTOMER_DETAILS_CUSTOMER_ID.87afa1b44c, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5)
[0m12:22:47.884887 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:22:47.893166 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5"
[0m12:22:47.894094 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:22:47.899973 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5"
[0m12:22:47.901529 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5"
[0m12:22:47.902203 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    PRODUCT_ID as unique_field,
    count(*) as n_records

from INSTRUCTOR1_vending_machine_dbt_db.RAW.PRODUCT_DETAILS
where PRODUCT_ID is not null
group by PRODUCT_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m12:22:47.902789 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:48.673210 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m12:22:48.676153 [info ] [Thread-2 (]: 17 of 20 PASS source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID .. [[32mPASS[0m in 0.79s]
[0m12:22:48.677113 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5
[0m12:22:48.677907 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:22:48.678743 [info ] [Thread-2 (]: 18 of 20 START test source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID  [RUN]
[0m12:22:48.679528 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_PRODUCT_DETAILS_PRODUCT_ID.67218121e5, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006)
[0m12:22:48.680116 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:22:48.688546 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006"
[0m12:22:48.689441 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:22:48.695130 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006"
[0m12:22:48.696682 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006"
[0m12:22:48.697366 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SURVEY_ID as unique_field,
    count(*) as n_records

from INSTRUCTOR1_vending_machine_dbt_db.RAW.SURVEY_FEEDBACK
where SURVEY_ID is not null
group by SURVEY_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m12:22:48.697951 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:49.379858 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m12:22:49.382818 [info ] [Thread-2 (]: 18 of 20 PASS source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID ... [[32mPASS[0m in 0.70s]
[0m12:22:49.383806 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006
[0m12:22:49.384541 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:22:49.385287 [info ] [Thread-2 (]: 19 of 20 START test source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID  [RUN]
[0m12:22:49.386095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_SURVEY_FEEDBACK_SURVEY_ID.b914621006, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c)
[0m12:22:49.386727 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:22:49.395312 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c"
[0m12:22:49.396211 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:22:49.404711 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c"
[0m12:22:49.406281 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c"
[0m12:22:49.406971 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    VENDING_MACHINE_ID as unique_field,
    count(*) as n_records

from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_MACHINES
where VENDING_MACHINE_ID is not null
group by VENDING_MACHINE_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m12:22:49.407558 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:50.109380 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m12:22:50.112310 [info ] [Thread-2 (]: 19 of 20 PASS source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID  [[32mPASS[0m in 0.73s]
[0m12:22:50.113268 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c
[0m12:22:50.113993 [debug] [Thread-2 (]: Began running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:22:50.114703 [info ] [Thread-2 (]: 20 of 20 START test source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID  [RUN]
[0m12:22:50.115472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_MACHINES_VENDING_MACHINE_ID.b0ed11a23c, now test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b)
[0m12:22:50.116065 [debug] [Thread-2 (]: Began compiling node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:22:50.124776 [debug] [Thread-2 (]: Writing injected SQL for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b"
[0m12:22:50.125719 [debug] [Thread-2 (]: Began executing node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:22:50.131751 [debug] [Thread-2 (]: Writing runtime sql for node "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b"
[0m12:22:50.133363 [debug] [Thread-2 (]: Using snowflake connection "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b"
[0m12:22:50.134064 [debug] [Thread-2 (]: On test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "vending_machine_dbt", "target_name": "dev", "node_id": "test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    TRANSACTION_ID as unique_field,
    count(*) as n_records

from INSTRUCTOR1_vending_machine_dbt_db.RAW.VENDING_TRANSACTIONS
where TRANSACTION_ID is not null
group by TRANSACTION_ID
having count(*) > 1



      
    ) dbt_internal_test
[0m12:22:50.134658 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:22:50.904805 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m12:22:50.907772 [info ] [Thread-2 (]: 20 of 20 PASS source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID  [[32mPASS[0m in 0.79s]
[0m12:22:50.908915 [debug] [Thread-2 (]: Finished running node test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b
[0m12:22:50.911766 [debug] [Dummy-1   ]: Connection 'master' was properly closed.
[0m12:22:50.912371 [debug] [Dummy-1   ]: Connection 'test.vending_machine_dbt.source_unique_vending_machine_dbt_db_VENDING_TRANSACTIONS_TRANSACTION_ID.a8aa03c31b' was properly closed.
[0m12:22:50.913008 [info ] [Dummy-1   ]: 
[0m12:22:50.913559 [info ] [Dummy-1   ]: Finished running 20 data tests in 0 hours 0 minutes and 15.52 seconds (15.52s).
[0m12:22:50.917820 [debug] [Dummy-1   ]: Command end result
[0m12:22:50.966240 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:22:50.969288 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:22:50.980207 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:22:50.980827 [info ] [Dummy-1   ]: 
[0m12:22:50.981498 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m12:22:50.982036 [info ] [Dummy-1   ]: 
[0m12:22:50.982563 [info ] [Dummy-1   ]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m12:22:50.984585 [debug] [Dummy-1   ]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 17.547709, "process_in_blocks": "0", "process_kernel_time": 1.37, "process_mem_max_rss": "431852", "process_out_blocks": "0", "process_user_time": 6.62}
[0m12:22:50.985305 [debug] [Dummy-1   ]: Command `cli test` succeeded at 12:22:50.985024 after 17.55 seconds
[0m12:22:50.985872 [debug] [Dummy-1   ]: Flushing usage events


============================== 12:23:39.432903 | 5cc7ba05-b2e9-4185-89e6-6acec250e2d2 ==============================
[0m12:23:39.432903 [info ] [Dummy-1   ]: Running with dbt=1.9.4
[0m12:23:39.434007 [debug] [Dummy-1   ]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/tmp/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': '/tmp/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': '/tmp/dbt/target/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m12:23:39.811333 [info ] [Dummy-1   ]: Registered adapter: snowflake=1.9.2
[0m12:23:40.580104 [debug] [Dummy-1   ]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:23:40.965899 [debug] [Dummy-1   ]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:40.966588 [debug] [Dummy-1   ]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:41.167876 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:23:41.171077 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:23:41.228843 [info ] [Dummy-1   ]: Found 9 models, 20 data tests, 5 sources, 592 macros
[0m12:23:41.231719 [warn ] [Dummy-1   ]: Nothing to do. Try checking your model configs and model specification args
[0m12:23:41.234218 [debug] [Dummy-1   ]: Command end result
[0m12:23:41.277343 [debug] [Dummy-1   ]: Wrote artifact WritableManifest to /tmp/dbt/target/manifest.json
[0m12:23:41.280013 [debug] [Dummy-1   ]: Wrote artifact SemanticManifest to /tmp/dbt/target/semantic_manifest.json
[0m12:23:41.284076 [debug] [Dummy-1   ]: Wrote artifact RunExecutionResult to /tmp/dbt/target/run_results.json
[0m12:23:41.284632 [info ] [Dummy-1   ]: 
[0m12:23:41.285334 [info ] [Dummy-1   ]: [32mCompleted successfully[0m
[0m12:23:41.285838 [info ] [Dummy-1   ]: 
[0m12:23:41.286374 [info ] [Dummy-1   ]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m12:23:41.288435 [debug] [Dummy-1   ]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.9519473, "process_in_blocks": "0", "process_kernel_time": 1.33, "process_mem_max_rss": "401172", "process_out_blocks": "0", "process_user_time": 4.79}
[0m12:23:41.289154 [debug] [Dummy-1   ]: Command `cli seed` succeeded at 12:23:41.288886 after 1.95 seconds
[0m12:23:41.289764 [debug] [Dummy-1   ]: Flushing usage events
